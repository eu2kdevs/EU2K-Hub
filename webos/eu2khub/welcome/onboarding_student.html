<!DOCTYPE html>
<html lang="hu">

<head>
  <meta charset="UTF-8">
  <meta name="description"
    content="Nagyon √∂r√ºl√ºnk hogy itt vagy vel√ºnk, √©s √©rdekl≈ëdsz a Hub ir√°nt. K√©rlek fejezd be ezt a gyors bemutat√≥t, √©s m√°ris elkezdheted haszn√°lni a Hubot!">
  <title data-translate="pages.onboarding_student.title">√údv√∂zl√ºnk a Hub-ban!</title>
  <link rel="stylesheet" href="onboarding_student.css">
  <link rel="icon" href="./favicon.ico">
  <!--
  <script type="importmap">
    {
      "imports": {
  "@material/web/": "../assets/js/material-web-all.js"
      }
    }
  </script>
  <script type="module">
  import '../assets/js/@material/web/all.js';
  import { styles as typescaleStyles } from '../assets/js/@material/web/md-typescale-styles.js';

    document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
  </script>
-->
  <script src="./assets/js/permissions.js"></script>
  <script src="./assets/js/translations.js"></script>
  <script src="./assets/js/welcome-screen.js"></script>
  <script src="../assets/js/dpad-navigation.js"></script>
  <script type="module">
    import { initializeApp } from "../assets/js/firebase-app-11.10.0.js";
    import { getAnalytics } from "../assets/js/firebase-analytics-11.10.0.js";
    import { getFirestore } from "../assets/js/firebase-firestore-11.10.0.js";
    import { getAuth, OAuthProvider, signInWithRedirect, getRedirectResult, onAuthStateChanged, signInWithPopup } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBRRVx6BtQtCDKjFYA8yh9qYrcUONmkkwI",
      authDomain: "eu2k-hub.firebaseapp.com",
      projectId: "eu2k-hub",
      storageBucket: "eu2k-hub.firebasestorage.app",
      messagingSenderId: "560244867055",
      appId: "1:560244867055:web:3cd51b85baead94989001a",
      measurementId: "G-2JDPR089WD"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getFirestore(app);
    const auth = getAuth(app);
    window.db = db;

    const msProvider = new OAuthProvider('microsoft.com');
    msProvider.setCustomParameters({ prompt: 'select_account' });
    try { msProvider.addScope('User.Read'); } catch (_) {}

    window.startMicrosoftSignIn = async () => {
      const isLocalhost = location.hostname === 'localhost' || location.hostname === '127.0.0.1';
      const tryRedirect = async () => {
        console.log('[Auth] Using redirect flow');
        await signInWithRedirect(auth, msProvider);
      };

      if (isLocalhost) {
        try {
          console.log('[Auth] Trying popup flow (localhost)');
          await signInWithPopup(auth, msProvider);
          console.log('[Auth] Popup sign-in success');
          proceedToProfileChooser(auth.currentUser);
        } catch (err) {
          console.warn('[Auth] Popup sign-in failed, falling back to redirect:', err);
          await tryRedirect();
        }
      } else {
        await tryRedirect();
      }
    };

    const proceedToProfileChooser = (user) => {
      try {
        if (user) {
          const nameEl = document.querySelector('.main-avatar-name');
          if (nameEl && user.displayName) nameEl.textContent = user.displayName;
          const imgEl = document.querySelector('.main-avatar-img');
          if (imgEl && user.photoURL) imgEl.src = user.photoURL;
          localStorage.setItem('eu2k-auth-logged-in', 'true');
          if (user.displayName) localStorage.setItem('eu2k-auth-display-name', user.displayName);
        }
      } catch (e) { console.warn('Prefill failed:', e); }
      try { localStorage.setItem('eu2k-onboarding-target', 'student-profile'); } catch (_) {}
      location.hash = 'student-profile';
    };

    getRedirectResult(auth).then((result) => {
      if (result && result.user) {
        try {
          const credential = OAuthProvider.credentialFromResult(result);
          const accessToken = credential && credential.accessToken;
          if (accessToken) {
            fetch('https://graph.microsoft.com/v1.0/me', {
              headers: { Authorization: `Bearer ${accessToken}` }
            }).then(r => r.json()).then(data => {
              if (data && data.displayName) {
                localStorage.setItem('eu2k-auth-display-name', data.displayName);
              }
            }).catch(() => {});
          }
        } catch (_) {}
        proceedToProfileChooser(result.user);
      }
    }).catch((error) => console.error('Microsoft sign-in error:', error));

    onAuthStateChanged(auth, (user) => {
      if (user && (location.hash === '' || location.hash === '#step2')) {
        proceedToProfileChooser(user);
      }
    });
  </script>

  <script>
    // Welcome onboarding navigation system
    let currentLanguage = 'hu'; // Default language

    function initializeWelcome() {
      const welcomePages = document.querySelectorAll('.welcome-page');

      function showPage(pageId) {
        console.log('Showing page:', pageId);

        // First fade out all active pages
        const currentActive = document.querySelector('.welcome-page.active');
        if (currentActive) {
          currentActive.classList.remove('active');
        }

        // Show target page - handle both with and without '-page' suffix
        let targetPage = document.getElementById(pageId + '-page');
        if (!targetPage) {
          targetPage = document.getElementById(pageId);
        }

        if (targetPage) {
          // Make sure it's visible but not active first
          targetPage.style.display = 'flex';

          // Small delay to ensure display change is processed
          setTimeout(() => {
            targetPage.classList.add('active');
          }, 10);

          console.log('Successfully showed page:', targetPage.id);
        } else {
          console.error('Page not found:', pageId);
        }

        // Hide non-active pages after transition
        setTimeout(() => {
          welcomePages.forEach(page => {
            if (!page.classList.contains('active')) {
              page.style.display = 'none';
            }
          });
        }, 500);
      }

      function navigate(event, pageId) {
        event.preventDefault();
        location.hash = pageId;
      }

      // Language selection handlers
      const languageButtons = document.querySelectorAll('.language-button');
      languageButtons.forEach(button => {
        button.addEventListener('click', e => {
          const language = button.getAttribute('data-language');
          currentLanguage = language;

          console.log('Language selected:', language);

          // Switch language in translation system
          if (window.translationManager) {
            console.log('Switching language to:', language);
            window.translationManager.switchLanguage(language);
          } else {
            console.log('Translation manager not available, waiting...');
            // Wait for translation manager to load
            setTimeout(() => {
              if (window.translationManager) {
                console.log('Translation manager loaded, switching language to:', language);
                window.translationManager.switchLanguage(language);
              } else {
                console.error('Translation manager still not available');
              }
            }, 500);
          }

          navigate(e, 'step2');
        });
      });

      // Navigation button handlers
      const navButtons = document.querySelectorAll('.nav-button');
      navButtons.forEach(button => {
        button.addEventListener('click', e => {
          const action = button.getAttribute('data-action');

          if (action === 'back-step1') {
            navigate(e, 'step1');
          } else if (action === 'back-step2') {
            // Check if we're in confirmation state
            const profileContent = document.querySelector('.profile-content');
            if (profileContent && profileContent.classList.contains('confirmation-state')) {
              // Revert to avatar selection instead of going back to step2
              e.preventDefault();
              revertAvatarConfirmation();
            } else {
              navigate(e, 'step2');
            }
          } else if (action === 'back-student-profile') {
            // Reset the student profile page to its original state
            resetStudentProfilePage();
            navigate(e, 'student-profile');
          } else if (action === 'back-notifications-setup') {
            navigate(e, 'notifications-setup');
          } else if (action === 'back-messages-setup') {
            navigate(e, 'messages-setup');
          } else if (action === 'student') {
            e.preventDefault();
            if (localStorage.getItem('eu2k-auth-logged-in') === 'true') {
              showPage('student-profile');
              return;
            }
            if (window.startMicrosoftSignIn) {
              window.startMicrosoftSignIn();
            } else {
              navigate(e, 'student-profile');
            }
          } else if (action === 'teacher') {
            navigate(e, 'teacher');
          } else if (action === 'without-account') {
            navigate(e, 'adult');
          }
        });
      });

      // Avatar selection handlers
      const avatarOptions = document.querySelectorAll('.avatar-option');
      const mainAvatarImg = document.querySelector('.main-avatar-img');
      const mainAvatar = document.querySelector('.main-avatar');

      avatarOptions.forEach(option => {
        option.addEventListener('click', () => {
          const avatarImg = option.querySelector('.avatar-img');
          const avatarSrc = avatarImg.src;
          const avatarType = option.getAttribute('data-avatar');

          // Update main avatar
          mainAvatarImg.src = avatarSrc;

          // Color maps for background and border based on actual avatar colors
          const backgroundColorMap = {
            'magenta': '#E8B4E3',
            'green': '#B4E8B4',
            'blue': '#B4D4E8',
            'orange': '#E8D4B4',
            'purple': '#D4B4E8',
            'cyan': '#B4E8E8',
            'red': '#E8B4B4',
            'gray': '#C4C4C4'
          };

          // Updated border colors to match avatar main colors
          const borderColorMap = {
            'magenta': '#D946EF', // Bright magenta/fuchsia
            'green': '#22C55E',   // Bright green
            'blue': '#3B82F6',    // Bright blue
            'orange': '#F97316',  // Bright orange
            'purple': '#A855F7',  // Bright purple
            'cyan': '#06B6D4',    // Bright cyan
            'red': '#EF4444',     // Bright red
            'gray': '#6B7280'     // Medium gray
          };

          // Update main avatar background
          mainAvatar.style.background = backgroundColorMap[avatarType] || '#E8B4E3';

          // Remove active class from all options
          avatarOptions.forEach(opt => {
            opt.classList.remove('active');
            opt.style.border = 'none';
          });

          // Add active class and colored border to selected option
          option.classList.add('active');
          option.style.border = `3px solid ${borderColorMap[avatarType]}`;
        });
      });

      // Hash change listener
      window.addEventListener('hashchange', () => {
        const page = location.hash.substring(1) || 'step1';
        showPage(page);
      });

      // Initial page load
      const initialPage = location.hash.substring(1) || 'step1';
      showPage(initialPage);

      // If an onboarding target was requested (e.g., after auth redirect), navigate there
      try {
        const target = localStorage.getItem('eu2k-onboarding-target');
        if (target) {
          localStorage.removeItem('eu2k-onboarding-target');
          showPage(target);
          location.hash = target;
        }
      } catch (_) {}

      // Set default avatar selection (magenta)
      setTimeout(() => {
        const defaultAvatar = document.querySelector('.avatar-option[data-avatar="magenta"]');
        if (defaultAvatar) {
          defaultAvatar.click();
        }
      }, 100);

      // Handle "Continue with this" button click
      const continueButton = document.getElementById('continue-with-avatar');
      if (continueButton) {
        continueButton.addEventListener('click', () => {
          showAvatarConfirmation();
        });
      }

      // Handle "Looks good" button click
      const looksGoodButton = document.getElementById('looks-good-button');
      if (looksGoodButton) {
        looksGoodButton.addEventListener('click', () => {
          showSuccessAnimation();
        });
      }

      // Handle "Continue notifications" button click
      const continueNotificationsButton = document.getElementById('continue-notifications');
      if (continueNotificationsButton) {
        continueNotificationsButton.addEventListener('click', () => {
          navigate(event, 'messages-setup');
        });
      }

      // Handle "Continue messages" button click
      const continueMessagesButton = document.getElementById('continue-messages');
      if (continueMessagesButton) {
        continueMessagesButton.addEventListener('click', () => {
          showPage('terms-setup');
        });
      }

      // Handle terms checkbox
      const termsCheckbox = document.getElementById('terms-checkbox');
      const continueTermsButton = document.getElementById('continue-terms');

      if (termsCheckbox && continueTermsButton) {
        termsCheckbox.addEventListener('change', (event) => {
          continueTermsButton.disabled = !event.target.checked;
        });
      }

      // Handle "Continue terms" button click
      if (continueTermsButton) {
        continueTermsButton.addEventListener('click', () => {
          const checkbox = document.getElementById('terms-checkbox');
          if (checkbox && checkbox.checked) {
            // Store acceptance in localStorage
            localStorage.setItem('termsAccepted', 'true');
            showPage('final-welcome-page');
          } else {
            alert('K√©rlek fogadd el a haszn√°lati felt√©teleket a folytat√°shoz!');
          }
        });
      }

      // Handle private messages switch toggle
      const privateMessagesSwitch = document.querySelector('#messages-setup-page .card-top md-switch');
      const messageRadios = document.querySelectorAll('#messages-setup-page md-radio[name="message-privacy"]');

      if (privateMessagesSwitch) {
        privateMessagesSwitch.addEventListener('change', (event) => {
          const isEnabled = event.target.selected;
          messageRadios.forEach(radio => {
            radio.disabled = !isEnabled;
          });
        });
      }
    }

    function showAvatarConfirmation() {
      const profileContent = document.querySelector('.profile-content');
      const welcomeDescription = document.querySelector('.welcome-description-header');
      const avatarSelection = document.querySelector('.avatar-selection');
      const profileActions = document.querySelector('.profile-actions');
      const confirmationActions = document.querySelector('.profile-actions-confirmation');
      const mainAvatarContainer = document.querySelector('.main-avatar-container');
      const profileDivider = document.querySelector('.profile-divider');

      // Add confirmation state class to profile content for avatar enlargement
      profileContent.classList.add('confirmation-state');

      // Update description text with translation support
      if (welcomeDescription) {
        welcomeDescription.setAttribute('data-translate', 'profile.looks_good_description');
        // Update text based on current language
        if (window.translationManager) {
          const translatedText = window.translationManager.getTranslation('profile.looks_good_description');
          welcomeDescription.textContent = translatedText;
        } else {
          welcomeDescription.textContent = currentLanguage === 'en' ? 'Does this look good?' : 'Ez √≠gy j√≥l n√©z ki?';
        }
      }

      // Hide avatar selection and original buttons with smooth transition
      if (avatarSelection) {
        avatarSelection.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
        avatarSelection.style.opacity = '0';
        avatarSelection.style.transform = 'translateY(-20px)';
        setTimeout(() => {
          avatarSelection.style.display = 'none';
        }, 400);
      }

      if (profileActions) {
        profileActions.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
        profileActions.style.opacity = '0';
        profileActions.style.transform = 'translateY(-20px)';
        setTimeout(() => {
          profileActions.style.display = 'none';
        }, 400);
      }

      if (profileDivider) {
        profileDivider.style.transition = 'opacity 0.4s ease';
        profileDivider.style.opacity = '0';
        setTimeout(() => {
          profileDivider.style.display = 'none';
        }, 400);
      }

      // Show confirmation button with smooth entrance transition
      setTimeout(() => {
        if (confirmationActions) {
          confirmationActions.style.display = 'flex';
          confirmationActions.style.opacity = '0';
          confirmationActions.style.transform = 'translateY(20px)';
          confirmationActions.style.transition = 'opacity 0.4s ease, transform 0.4s ease';

          setTimeout(() => {
            confirmationActions.style.opacity = '1';
            confirmationActions.style.transform = 'translateY(0)';
          }, 50);
        }
      }, 400);
    }

    function revertAvatarConfirmation() {
      const profileContent = document.querySelector('.profile-content');
      const welcomeDescription = document.querySelector('.welcome-description-header');
      const avatarSelection = document.querySelector('.avatar-selection');
      const profileActions = document.querySelector('.profile-actions');
      const confirmationActions = document.querySelector('.profile-actions-confirmation');
      const profileDivider = document.querySelector('.profile-divider');

      // Remove confirmation state class
      profileContent.classList.remove('confirmation-state');

      // Revert description text
      if (welcomeDescription) {
        welcomeDescription.setAttribute('data-translate', 'pages.onboarding_student.create_account_description');
        if (window.translationManager) {
          const translatedText = window.translationManager.getTranslation('pages.onboarding_student.create_account_description');
          welcomeDescription.textContent = translatedText;
        } else {
          welcomeDescription.textContent = currentLanguage === 'en' ? 'Please choose an avatar or use the one provided by your school account!' : 'K√©rlek v√°lassz egy avat√°rt, vagy haszn√°ld az iskolai fi√≥kod √°ltal biztos√≠tottat!';
        }
      }

      // Hide confirmation actions
      if (confirmationActions) {
        confirmationActions.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
        confirmationActions.style.opacity = '0';
        confirmationActions.style.transform = 'translateY(20px)';
        setTimeout(() => {
          confirmationActions.style.display = 'none';
        }, 400);
      }

      // Show avatar selection and original buttons
      setTimeout(() => {
        if (avatarSelection) {
          avatarSelection.style.display = 'block';
          avatarSelection.style.opacity = '0';
          avatarSelection.style.transform = 'translateY(-20px)';
          avatarSelection.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
          setTimeout(() => {
            avatarSelection.style.opacity = '1';
            avatarSelection.style.transform = 'translateY(0)';
          }, 50);
        }

        if (profileActions) {
          profileActions.style.display = 'flex';
          profileActions.style.opacity = '0';
          profileActions.style.transform = 'translateY(-20px)';
          profileActions.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
          setTimeout(() => {
            profileActions.style.opacity = '1';
            profileActions.style.transform = 'translateY(0)';
          }, 50);
        }

        if (profileDivider) {
          profileDivider.style.display = 'block';
          profileDivider.style.opacity = '0';
          profileDivider.style.transition = 'opacity 0.4s ease';
          setTimeout(() => {
            profileDivider.style.opacity = '1';
          }, 50);
        }
      }, 400);
    }

    function resetStudentProfilePage() {
      // Reset the publish layout visibility
      const publishLayout = document.querySelector('.publish-layout');
      if (publishLayout) {
        publishLayout.style.opacity = '1';
        publishLayout.style.transition = '';
      }

      // Reset profile content to avatar selection state
      const profileContent = document.querySelector('.profile-content');
      const welcomeDescription = document.querySelector('.welcome-description-header');
      const avatarSelection = document.querySelector('.avatar-selection');
      const profileActions = document.querySelector('.profile-actions');
      const confirmationActions = document.querySelector('.profile-actions-confirmation');
      const profileDivider = document.querySelector('.profile-divider');

      // Remove confirmation state
      if (profileContent) {
        profileContent.classList.remove('confirmation-state');
      }

      // Reset description text
      if (welcomeDescription) {
        welcomeDescription.setAttribute('data-translate', 'pages.onboarding_student.create_account_description');
        if (window.translationManager) {
          const translatedText = window.translationManager.getTranslation('pages.onboarding_student.create_account_description');
          welcomeDescription.textContent = translatedText;
        } else {
          welcomeDescription.textContent = currentLanguage === 'en' ? 'Please choose an avatar or use the one provided by your school account!' : 'K√©rlek v√°lassz egy avat√°rt, vagy haszn√°ld az iskolai fi√≥kod √°ltal biztos√≠tottat!';
        }
      }

      // Show all original elements
      if (avatarSelection) {
        avatarSelection.style.display = 'block';
        avatarSelection.style.opacity = '1';
        avatarSelection.style.transform = 'translateY(0)';
        avatarSelection.style.transition = '';
      }

      if (profileActions) {
        profileActions.style.display = 'flex';
        profileActions.style.opacity = '1';
        profileActions.style.transform = 'translateY(0)';
        profileActions.style.transition = '';
      }

      if (profileDivider) {
        profileDivider.style.display = 'block';
        profileDivider.style.opacity = '1';
        profileDivider.style.transition = '';
      }

      // Hide confirmation actions
      if (confirmationActions) {
        confirmationActions.style.display = 'none';
        confirmationActions.style.opacity = '0';
        confirmationActions.style.transform = 'translateY(20px)';
        confirmationActions.style.transition = '';
      }
    }

    function showSuccessAnimation() {
      // Hide the publish layout
      const publishLayout = document.querySelector('.publish-layout');
      if (publishLayout) {
        publishLayout.style.opacity = '0';
        publishLayout.style.transition = 'opacity 0.3s ease';
      }

      // Create success animation overlay that covers the whole screen
      const overlay = document.createElement('div');
      overlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
        pointer-events: none;
      `;

      // Create the success text element
      const successText = document.createElement('div');
      successText.textContent = window.translationManager ? window.translationManager.getTranslation('profile.super') || 'Szuper!' : 'Szuper!';
      successText.style.cssText = `
        font-size: 3rem;
        font-weight: 700;
        color: #1976d2;
        opacity: 0;
        transform: translateY(50px);
        transition: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      `;

      overlay.appendChild(successText);
      document.body.appendChild(overlay);

      // Animate text to center
      setTimeout(() => {
        successText.style.opacity = '1';
        successText.style.transform = 'translateY(0)';
      }, 100);

      // Gravity fall animation and navigate
      setTimeout(() => {
        successText.style.transition = 'all 0.8s cubic-bezier(0.55, 0.085, 0.68, 0.53)';
        successText.style.transform = 'translateY(200px)';
        successText.style.opacity = '0';

        setTimeout(() => {
          document.body.removeChild(overlay);
          // Navigate to notifications setup page
          location.hash = 'notifications-setup';
        }, 800);
      }, 1500);
    }

    // Check terms acceptance and redirect
    function checkTermsAndRedirect() {
      const termsAccepted = localStorage.getItem('termsAccepted');
      if (termsAccepted === 'true') {
        // Megjel√∂lj√ºk, hogy a felhaszn√°l√≥ m√°r l√°togatta az oldalt
        if (window.welcomeScreenManager) {
          window.welcomeScreenManager.markAsVisited();
          // Visszat√©r√©s az eredeti oldalra
          window.welcomeScreenManager.returnFromWelcomeScreen();
        } else {
          // Fallback ha nincs welcome screen manager
          window.location.href = './index.html';
        }
      } else {
        alert('K√©rlek fejezd be az onboarding folyamatot √©s fogadd el a haszn√°lati felt√©teleket!');
        showPage('terms-setup-page');
      }
    }

    // Initialize on DOM load
    document.addEventListener('DOMContentLoaded', () => {
      // Wait a bit for translation manager to load
      setTimeout(() => {
        initializeWelcome();

        // Check if translation manager is available
        if (window.translationManager) {
          console.log('Translation manager is available');
        } else {
          console.log('Translation manager not yet available');
        }
      }, 100);
    });
  </script>
-->
</head>

<body>
  <div class="app-bg">
    <main class="main-area">
      <div class="main-content">

        <!-- Step 1: Language Selection -->
        <div id="step1-page" class="welcome-page active">
          <div class="welcome-container">
            <!-- K√©z ikon -->
            <img src="./assets/welcome_hand_icon.svg" class="welcome-hand-icon" alt="Waving Hand">

            <!-- √údv√∂zl≈ë Sz√∂veg -->
            <h1 class="welcome-title" data-translate="pages.onboarding_student.welcome-title">√údv√∂z√∂llek a Hub-ban!</h1>

            <!-- Nyelvgombok -->
            <div class="welcome-description">
              <button class="welcome-button language-button" data-language="hu" tabindex="0">
                <img src="./assets/settings_icons/general_page/hungarian.png" class="welcome-icon"
                  alt="HU-Flag">
                <span class="welcome-text" data-translate="settings.language_hungarian">Magyar</span>
              </button>
              <button class="welcome-button-secondary language-button" data-language="en" tabindex="0">
                <img src="./assets/settings_icons/general_page/english.png" class="welcome-icon" alt="EN-Flag">
                <span class="welcome-text" data-translate="settings.language_english">English</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Step 2: User Type Selection -->
        <div id="step2-page" class="welcome-page">
          <div class="welcome-container">
            <!-- K√©z ikon -->
            <img src="./assets/welcome_hand_icon.svg" class="welcome-hand-icon" alt="Waving Hand">

            <!-- √údv√∂zl≈ë Sz√∂veg -->
            <h1 class="welcome-title" data-translate="pages.onboarding_student.welcome-title">√údv√∂z√∂llek a Hub-ban!</h1>

            <!-- Navigation buttons -->
            <div class="welcome-navigation">
              <button class="welcome-nav-button nav-button" data-action="back-step1" tabindex="0">
                <img src="./assets/welcome_icons/back.svg" class="welcome-nav-icon" alt="Back">
                <span class="welcome-nav-text" data-translate="navigation.back">Vissza</span>
              </button>

              <button class="welcome-nav-button-primary nav-button" data-action="student" tabindex="0">
                <img src="./assets/welcome_icons/student.svg" class="welcome-nav-icon" alt="Student">
                <span class="welcome-nav-text" data-translate="onboarding.continue_as_student">Tov√°bb di√°kk√©nt</span>
              </button>

              <button class="welcome-nav-button-primary nav-button" data-action="teacher" tabindex="0">
                <img src="./assets/welcome_icons/teacher.svg" class="welcome-nav-icon" alt="Teacher">
                <span class="welcome-nav-text" data-translate="onboarding.continue_as_teacher">Tov√°bb tan√°rk√©nt</span>
              </button>

              <button class="welcome-nav-button-last nav-button" data-action="without-account" tabindex="0">
                <img src="./assets/welcome_icons/without_account.svg" class="welcome-nav-icon"
                  alt="Without Account">
                <span class="welcome-nav-text" data-translate="onboarding.continue_without_account">Tov√°bb
                  feln≈ëttk√©nt</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Step 3: Teacher Page -->
        <div id="teacher-page" class="welcome-page">
          <div class="welcome-container">
            <!-- K√©z ikon -->
            <img src="./assets/welcome_hand_icon.svg" class="welcome-hand-icon" alt="Waving Hand">

            <!-- √údv√∂zl≈ë Sz√∂veg -->
            <h1 class="welcome-title" data-translate="pages.onboarding_student.welcome_hub">√údv√∂zl√ºnk a Hub-ban!</h1>

            <!-- Le√≠r√°s -->
            <p class="welcome-description-text" data-translate="pages.onboarding_student.teacher_description">
              √ögy l√°tszik, tan√°r vagy! Nagyra √©rt√©kelj√ºk hogy megpr√≥b√°lod felfedezni a Hub √°ltal ny√∫jtott
              v√©gtelen lehet≈ës√©geket (na j√≥ az√©rt nem üòä), de a Hub a b√©ta szakasz elej√©n van.
              Tan√°roknak is nemsok√°ra el√©rhet≈ë lesz!
            </p>

            <!-- Vissza gomb -->
            <div class="welcome-back-button-container">
              <button class="welcome-back-button nav-button" data-action="back-step2" tabindex="0">
                <img src="./assets/welcome_icons/back.svg" class="welcome-back-icon" alt="Back">
                <span class="welcome-back-text" data-translate="navigation.back">Vissza</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Step 3: Adult Page -->
        <div id="adult-page" class="welcome-page">
          <div class="welcome-container">
            <!-- K√©z ikon -->
            <img src="./assets/welcome_hand_icon.svg" class="welcome-hand-icon" alt="Waving Hand">

            <!-- √údv√∂zl≈ë Sz√∂veg -->
            <h1 class="welcome-title" data-translate="pages.onboarding_student.welcome_hub">√údv√∂zl√ºnk a Hub-ban!</h1>

            <!-- Le√≠r√°s -->
            <p class="welcome-description-text" data-translate="pages.onboarding_student.adult_description">
              √ögy l√°tszik, feln≈ëtt vagy! Nagyra √©rt√©kelj√ºk hogy megpr√≥b√°lod felfedezni a Hub √°ltal ny√∫jtott
              v√©gtelen lehet≈ës√©geket (na j√≥ az√©rt nem üòä), de a Hub a b√©ta szakasz elej√©n van.
              Feln≈ëtteknek is nemsok√°ra el√©rhet≈ë lesz!
            </p>

            <!-- Vissza gomb -->
            <div class="welcome-back-button-container">
              <button class="welcome-back-button nav-button" data-action="back-step2" tabindex="0">
                <img src="./assets/welcome_icons/back.svg" class="welcome-back-icon" alt="Back">
                <span class="welcome-back-text" data-translate="navigation.back">Vissza</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Step 3: Student Profile Setup -->
        <div id="student-profile-page" class="welcome-page">
          <div class="publish-layout">
            <div class="publish-content">
              <div class="publish-content-header">
                <button class="back-arrow-btn nav-button" data-action="back-step2" tabindex="0">
                  <img src="./assets/welcome_icons/back.svg" alt="Vissza" class="arrow-img">
                </button>
                <div class="welcome-container-header">
                  <img src="./assets/welcome_hand_icon.svg" class="welcome-icon-header" alt="Welcome">
                  <h1 class="welcome-text-header" data-translate="pages.onboarding_student.welcome_hub">√údv√∂zl√ºnk a
                    Hub-ban!</h1>
                  <p class="welcome-description-header"
                    data-translate="pages.onboarding_student.create_account_description">K√©rlek v√°lassz egy avat√°rt,
                    vagy
                    haszn√°ld az iskolai fi√≥kod √°ltal biztos√≠tottat!</p>
                </div>
              </div>
            </div>

            <!-- Profile Setup Content - Right Column -->
            <div class="profile-content">
              <!-- Main Avatar -->
              <div class="main-avatar-container">
                <div class="main-avatar">
                  <img src="./assets/avatars/magenta.png" class="main-avatar-img" alt="Avatar">
                </div>
                <div class="main-avatar-name" data-translate="profile.student_name">Tur√≥czi √Åd√°m - 8.E</div>
              </div>

              <!-- Divider -->
              <div class="profile-divider"></div>

              <!-- Avatar Selection -->
              <div class="avatar-selection">
                <div class="avatar-row">
                  <div class="avatar-option" data-avatar="magenta">
                    <img src="./assets/avatars/magenta.png" class="avatar-img" alt="Avatar 1">
                  </div>
                  <div class="avatar-option" data-avatar="green">
                    <img src="./assets/avatars/green.png" class="avatar-img" alt="Avatar 2">
                  </div>
                  <div class="avatar-option" data-avatar="blue">
                    <img src="./assets/avatars/blue.png" class="avatar-img" alt="Avatar 3">
                  </div>
                  <div class="avatar-option" data-avatar="orange">
                    <img src="./assets/avatars/orange.png" class="avatar-img" alt="Avatar 4">
                  </div>
                  <div class="avatar-option" data-avatar="purple">
                    <img src="./assets/avatars/purple.png" class="avatar-img" alt="Avatar 5">
                  </div>
                </div>
                <div class="avatar-row">
                  <div class="avatar-option" data-avatar="cyan">
                    <img src="./assets/avatars/light_blue.png" class="avatar-img" alt="Avatar 6">
                  </div>
                  <div class="avatar-option" data-avatar="red">
                    <img src="./assets/avatars/red.png" class="avatar-img" alt="Avatar 7">
                  </div>
                  <div class="avatar-option" data-avatar="gray">
                    <img src="./assets/avatars/black.png" class="avatar-img" alt="Avatar 8">
                  </div>
                </div>
              </div>

              <!-- Action Buttons -->
              <div class="profile-actions">
                <button class="profile-button-secondary" tabindex="0">
                  <img src="./assets/welcome_icons/student.svg" class="profile-button-icon"
                    alt="School Account">
                  <span class="profile-button-text" data-translate="profile.use_school_account">Tov√°bb az iskolai
                    profilk√©ppel</span>
                </button>
                <button class="profile-button-primary" id="continue-with-avatar" tabindex="0">
                  <img src="./assets/welcome_icons/arrow_right.svg" class="profile-button-icon" alt="Continue">
                  <span class="profile-button-text" data-translate="profile.continue">Tov√°bb ezzel</span>
                </button>
              </div>

              <!-- Confirmation State (initially hidden) -->
              <div class="profile-actions profile-actions-confirmation" style="display: none;">
                <button class="profile-button-primary profile-button-confirmation" id="looks-good-button" tabindex="0">
                  <img src="./assets/welcome_icons/smiley.svg" class="profile-button-icon" alt="Looks Good">
                  <span class="profile-button-text" data-translate="profile.looks_good">J√≥l n√©zek ki!</span>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 4: Notifications Setup -->
        <div id="notifications-setup-page" class="welcome-page">
          <div class="publish-layout">
            <div class="publish-content">
              <div class="publish-content-header">
                <button class="back-arrow-btn nav-button" data-action="back-student-profile" tabindex="0">
                  <img src="./assets/welcome_icons/back.svg" alt="Vissza" class="arrow-img">
                </button>
                <div class="welcome-container-header">
                  <img src="./assets/welcome_hand_icon.svg" class="welcome-icon-header" alt="Welcome">
                  <h1 class="welcome-text-header" data-translate="pages.onboarding_student.notifications_title">
                    √ârtes√≠t√©sek be√°ll√≠t√°sa</h1>
                  <p class="welcome-description-header"
                    data-translate="pages.onboarding_student.notifications_description">V√°laszd ki, milyen √©rtes√≠t√©seket
                    szeretn√©l kapni!</p>
                </div>
              </div>
            </div>

            <!-- Vertical Divider -->
            <div class="notifications-vertical-divider"></div>

            <!-- Notifications Content - Right Column -->
            <div class="profile-content notifications-content">
              <!-- Notice k√°rtya -->
              <div class="notifications-notice">
                <img src="./assets/settings_icons/notifications_page/info.svg" class="notice-icon" alt="Info">
                <span class="notice-text" data-translate="settings.notifications_notice">Am√≠g az iskol√°ban vagy, csendes
                  √©rtes√≠t√©seket fogsz kapni.</span>
              </div>

              <!-- Kateg√≥ri√°k k√°rtya -->
              <div class="notifications-categories-card">
                <div class="categories-title" data-translate="settings.categories">Kateg√≥ri√°k</div>

                <div class="category-items">
                  <!-- H√≠rek -->
                  <div class="category-item first">
                    <img src="./assets/settings_icons/notifications_page/news.svg" class="category-icon"
                      alt="H√≠rek">
                    <span class="category-text" data-translate="settings.news">H√≠rek</span>
                    <md-switch icons selected></md-switch>
                  </div>

                  <!-- Kurzusok -->
                  <div class="category-item middle">
                    <img src="./assets/settings_icons/notifications_page/courses.svg" class="category-icon"
                      alt="Kurzusok">
                    <span class="category-text" data-translate="settings.courses">Kurzusok</span>
                    <md-switch icons disabled></md-switch>
                  </div>

                  <!-- Esem√©nyek -->
                  <div class="category-item middle">
                    <img src="./assets/settings_icons/notifications_page/events.svg" class="category-icon"
                      alt="Esem√©nyek">
                    <span class="category-text" data-translate="settings.events">Esem√©nyek</span>
                    <md-switch icons selected></md-switch>
                  </div>

                  <!-- √úzenetek -->
                  <div class="category-item middle">
                    <img src="./assets/settings_icons/notifications_page/messages.svg" class="category-icon"
                      alt="√úzenetek">
                    <span class="category-text" data-translate="settings.messages">√úzenetek</span>
                    <md-switch icons disabled></md-switch>
                  </div>

                  <!-- Posztok -->
                  <div class="category-item middle">
                    <img src="./assets/settings_icons/notifications_page/posts.svg" class="category-icon"
                      alt="Posztok">
                    <span class="category-text" data-translate="settings.posts">Posztok</span>
                    <md-switch icons disabled></md-switch>
                  </div>

                  <!-- Megh√≠v√≥k -->
                  <div class="category-item middle">
                    <img src="./assets/settings_icons/notifications_page/invites.svg" class="category-icon"
                      alt="Megh√≠v√≥k">
                    <span class="category-text" data-translate="settings.invites">Megh√≠v√≥k</span>
                    <md-switch icons disabled></md-switch>
                  </div>

                  <!-- B√©taverzi√≥ -->
                  <div class="category-item middle">
                    <img src="./assets/settings_icons/notifications_page/beta_version.svg" class="category-icon"
                      alt="B√©taverzi√≥">
                    <span class="category-text" data-translate="settings.beta_version">B√©taverzi√≥</span>
                    <md-switch icons disabled selected></md-switch>
                  </div>

                  <!-- √öjdons√°gok -->
                  <div class="category-item middle">
                    <img src="./assets/settings_icons/notifications_page/new_things.svg" class="category-icon"
                      alt="√öjdons√°gok">
                    <span class="category-text" data-translate="settings.new_things">√öjdons√°gok</span>
                    <md-switch icons disabled selected></md-switch>
                  </div>

                  <!-- Cseng≈ë -->
                  <div class="category-item last">
                    <img src="./assets/settings_icons/notifications_page/bell.svg" class="category-icon"
                      alt="Cseng≈ë">
                    <span class="category-text" data-translate="settings.bell">Cseng≈ë</span>
                    <md-switch icons disabled></md-switch>
                  </div>
                </div>

                <!-- Continue Button - Inside categories card -->
                <div class="notifications-actions">
                  <button class="notifications-continue-button" id="continue-notifications" tabindex="0">
                    <img src="./assets/arrow_forward.svg" class="profile-button-icon" alt="Next">
                    <span class="notifications-continue-text" data-translate="navigation.continue">Tov√°bb</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 5: Messages Setup -->
        <div id="messages-setup-page" class="welcome-page">
          <div class="publish-layout">
            <div class="publish-content">
              <div class="publish-content-header">
                <button class="back-arrow-btn nav-button" data-action="back-notifications-setup" tabindex="0">
                  <img src="./assets/welcome_icons/back.svg" alt="Vissza" class="arrow-img">
                </button>
                <div class="welcome-container-header">
                  <img src="./assets/welcome_hand_icon.svg" class="welcome-icon-header" alt="Welcome">
                  <h1 class="welcome-text-header" data-translate="pages.onboarding_student.messages_title">
                    √úzenetek be√°ll√≠t√°sa</h1>
                  <p class="welcome-description-header" data-translate="pages.onboarding_student.messages_description">
                    D√∂ntsd el, hogy nyitott vagy-e a priv√°t √ºzenetekre!</p>
                </div>
              </div>
            </div>

            <!-- Vertical Divider -->
            <div class="notifications-vertical-divider"></div>

            <!-- Messages Content - Right Column -->
            <div class="profile-content messages-content">
              <div class="card card-top">
                <span data-translate="pages.account.private_messages">Priv√°t √úzenetek</span>
                <md-switch icons selected></md-switch>
              </div>

              <div class="card card-bottom">
                <span data-translate="pages.account.who_can_message">Ki k√ºldhet neked √ºzeneteket?</span>
                <div class="notice">
                  <img src="./assets/warning.svg" class="notice-icon" alt="Info">
                  <span data-translate="pages.account.message_notice">Ezt a be√°ll√≠t√°st csak te tudod m√≥dos√≠tani.</span>
                </div>
                <div class="radio-group">
                  <div class="radio-item">
                    <span data-translate="pages.account.everyone">Mindenki</span>
                    <md-radio name="message-privacy" value="everyone"></md-radio>
                  </div>
                  <div class="radio-item">
                    <span data-translate="pages.account.nobody">Senki</span>
                    <md-radio name="message-privacy" value="nobody" checked></md-radio>
                  </div>
                  <div class="radio-item">
                    <span data-translate="pages.account.classmates_only">Csak oszt√°lyt√°rsak</span>
                    <md-radio name="message-privacy" value="classmates"></md-radio>
                  </div>
                </div>
              </div>

              <!-- Continue Button -->
              <div class="messages-actions">
                <button class="messages-continue-button" id="continue-messages" tabindex="0">
                  <img src="./assets/arrow_forward.svg" class="profile-button-icon" alt="Next">
                  <span class="notifications-continue-text" data-translate="navigation.continue">Tov√°bb</span>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 6: Terms of Service -->
        <div id="terms-setup-page" class="welcome-page">
          <div class="publish-layout">
            <div class="publish-content">
              <div class="publish-content-header">
                <button class="back-arrow-btn nav-button" data-action="back-messages-setup" tabindex="0">
                  <img src="./assets/welcome_icons/back.svg" alt="Vissza" class="arrow-img">
                </button>
                <div class="welcome-container-header">
                  <img src="./assets/welcome_icons/terms_of_service.svg" class="welcome-icon-header"
                    alt="Terms of Service">
                  <h1 class="welcome-text-header" data-translate="pages.onboarding_student.terms_title">
                    Fogadd el k√©rlek a haszn√°lati felt√©teleket!</h1>
                  <p class="welcome-description-header" data-translate="pages.onboarding_student.terms_description">
                    Olvasd v√©gig, vagy tudj meg t√∂bbet, √©s fogadd el a t√°j√©koztat√≥t, √©s be is fejezt√ºk!</p>
                </div>
              </div>
            </div>

            <!-- Vertical Divider -->
            <div class="terms-vertical-divider"></div>

            <!-- Terms Content - Right Column -->
            <div class="profile-content terms-content">
              <div class="terms-scroll-area">
                <div class="terms-section terms-section-first">
                  <h3>
                    <img src="./assets/welcome_icons/message.svg" class="terms-icon" alt="Messages">
                    <span data-translate="pages.onboarding_student.terms_messaging_title">√úzenetk√ºld√©s √©s
                      fel√ºgyelet</span>
                  </h3>
                  <ul>
                    <li data-translate="pages.onboarding_student.terms_messaging_1">A Hub lehet≈ës√©get biztos√≠t k√∂z√∂ss√©gi
                      √©s kurzuson bel√ºli kommunik√°ci√≥ra.</li>
                    <li data-translate="pages.onboarding_student.terms_messaging_2">A Hub lehet≈ës√©get biztos√≠t k√∂z√∂ss√©gi
                      √©s kurzuson bel√ºli kommunik√°ci√≥ra.</li>
                  </ul>
                </div>

                <div class="terms-section terms-section-middle">
                  <h3>
                    <img src="./assets/welcome_icons/account_protection.svg" class="terms-icon"
                      alt="Account Protection">
                    <span data-translate="pages.onboarding_student.terms_accounts_title">Felhaszn√°l√≥i fi√≥kok √©s
                      jogosults√°gok</span>
                  </h3>
                  <ul>
                    <li data-translate="pages.onboarding_student.terms_accounts_1">A Hub egy k√∂zponti, iskolai rendszer,
                      melyet t√∂bbf√©le szerepben (tan√°r, di√°k, sz√ºl≈ë) lehet
                      haszn√°lni.</li>
                    <li data-translate="pages.onboarding_student.terms_accounts_2">A di√°kok sz√°m√°ra elk√ºl√∂n√≠tett r√©szhez
                      kiz√°r√≥lag iskolai fi√≥kkal lehet hozz√°f√©rni.</li>
                    <li data-translate="pages.onboarding_student.terms_accounts_3">A k√ºls≈ës email c√≠mek nem
                      haszn√°lhat√≥k, csak sz√ºl≈ëi fi√≥k l√©trehoz√°s√°ra.</li>
                    <li data-translate="pages.onboarding_student.terms_accounts_4">Amennyiben a rendszer vissza√©l√©st
                      √©szlel (pl. sz√ºl≈ëi fi√≥kot haszn√°l√≥ di√°k), fenntartjuk a jogot
                      a fi√≥k t√≠pus√°nak m√≥dos√≠t√°s√°ra, √©rtes√≠t√©s k√ºld√©s√©re, √©s ak√°r funkci√≥k korl√°toz√°s√°ra is.</li>
                    <li data-translate="pages.onboarding_student.terms_accounts_5">A rendszer b√°rmilyen fajta
                      kihaszn√°l√°sa nem enged√©lyezett, kihaszn√°l√°sa b√ºntet√©st von maga ut√°n.
                    </li>
                  </ul>
                </div>

                <div class="terms-section terms-section-middle">
                  <h3>
                    <img src="./assets/welcome_icons/supervision.svg" class="terms-icon" alt="Supervision">
                    <span data-translate="pages.onboarding_student.terms_responsibility_title">Felel≈ëss√©g</span>
                  </h3>
                  <ul>
                    <li>A Hubban el√©rhet≈ë kurzusokat k√ºls≈ë vagy bels≈ë szervez≈ëk (‚Äûhostok‚Äù) m≈±k√∂dtetik.</li>
                    <li>A kurzusok√©rt kiz√°r√≥lag a kurzus hostja felel.</li>
                    <li>A Hub, az iskola, √©s a platform fejleszt≈ëi nem v√°llalnak felel≈ëss√©get a kurzusok tartalm√°√©rt,
                      id≈ëpontj√°√©rt vagy esetleges technikai hib√°k√©rt.</li>
                    <li>A Hub a b√©taszakaszban nem rendelkezik moder√°ci√≥s rendszerrel, emiatt a k√∂z√∂ss√©gi funcki√≥k
                      korl√°tozottak, vagy hi√°nyz√≥ak is lehetnek.</li>
                  </ul>
                </div>

                <div class="terms-section terms-section-last">
                  <h3>
                    <img src="./assets/welcome_icons/feedback.svg" class="terms-icon" alt="Feedback">
                    <span data-translate="pages.onboarding_student.terms_feedback_title">Visszajelz√©sek √©s b√©ta
                      funkci√≥k</span>
                  </h3>
                  <ul>
                    <li data-translate="pages.onboarding_student.terms_feedback_1">Nagyra √©rt√©kelj√ºk a visszajelz√©seidet
                      ‚Äì ezek seg√≠tik a Hub fejl≈ëd√©s√©t!</li>
                    <li data-translate="pages.onboarding_student.terms_feedback_2">Viszont, a visszajelz≈ë, hibabejelent≈ë
                      √©s javaslati funkci√≥kat csak tiszteletteljes, j√≥ sz√°nd√©k√∫
                      m√≥don lehet haszn√°lni.</li>
                    <li data-translate="pages.onboarding_student.terms_feedback_3">A rendszer vissza√©l√©sszer≈± haszn√°lata
                      (pl. spamel√©s, hamis jelent√©sek, s√©rt≈ë hangnem) a
                      visszajelz√©si lehet≈ës√©gek korl√°toz√°s√°t vonhatja maga ut√°n.</li>
                    <li data-translate="pages.onboarding_student.terms_feedback_4">Ha b√©ta verzi√≥t haszn√°lsz, azonnali
                      kiz√°r√°sra ker√ºlhetsz ezekb≈ël a programokb√≥l s√∫lyosabb
                      szab√°lys√©rt√©s eset√©n.</li>
                    <li data-translate="pages.onboarding_student.terms_feedback_5">Mivel a Hub m√©g csak el≈ë-b√©ta
                      szakaszban j√°r, nagyra √©rt√©kelj√ºk a visszajelz√©sed. Minden
                      visszajelz√©s ut√°n valamilyen jutalmat tudunk neked adni, ha a visszajelz√©sed hasznos.</li>
                    <li data-translate="pages.onboarding_student.terms_feedback_6">A visszajelz√©seket egy ember
                      √©rt√©keli.</li>
                  </ul>
                </div>
              </div>

              <!-- Terms Acceptance -->
              <div class="terms-acceptance">
                <label class="terms-acceptance-label">
                  <md-checkbox id="terms-checkbox"></md-checkbox>
                  <span class="terms-acceptance-text"
                    data-translate="pages.onboarding_student.terms_acceptance_text">Elfogadom a haszn√°lati felt√©teleket
                    √©s az adatkezel√©si
                    t√°j√©koztat√≥t</span>
                </label>
              </div>

              <!-- Continue Button - Fixed at bottom -->
              <div class="terms-actions">
                <button class="terms-continue-button" id="continue-terms" disabled tabindex="0">
                  <img src="./assets/arrow_forward.svg" class="profile-button-icon" alt="Next">
                  <span class="terms-continue-text" data-translate="pages.onboarding_student.accept">Elfogadom</span>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 7: Final Welcome -->
        <div id="final-welcome-page" class="welcome-page">
          <div class="final-welcome-container">
            <img src="./assets/welcome_icons/smiley_animated.gif" class="final-welcome-gif" alt="Welcome">
            <h1 class="final-welcome-title" data-translate="pages.onboarding_student.final_welcome_title">K√©sz is
              vagyunk!</h1>
            <button class="final-welcome-button" onclick="checkTermsAndRedirect()" tabindex="0">
              <img src="./assets/welcome_icons/wave.svg" class="final-welcome-icon" alt="Wave">
              <span data-translate="pages.onboarding_student.final_welcome_start">Kezd√©s</span>
            </button>
          </div>
        </div>
      </div>

  </div>
  </main>
  </div>
</body>

</html>