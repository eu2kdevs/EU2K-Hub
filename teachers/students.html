<!DOCTYPE html>
<html lang="hu">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="Üdvözöllek az EU2K Hub-ban! Fedezd fel a legújabb eseményeket, híreket és tanulási lehetőségeket egy helyen.">
  <title data-translate="pages.index.title" data-translate-fallback="EU2K Hub">EU2K Teacher Hub</title>
  <link rel="stylesheet" href="students.css">
  <link rel="icon" href="/EU2K-Hub/favicon.ico">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap');

    body,
    * {
      font-family: "Roboto", sans-serif;
      font-optical-sizing: auto;
      font-weight: 400;
      font-style: normal;
      font-variation-settings: "wdth" 100;
    }

    /* Scrollbar elrejtése a news carousel-ben */
    #newsRow {
      scrollbar-width: none;
      /* Firefox */
      -ms-overflow-style: none;
      /* Internet Explorer 10+ */
    }

    #newsRow::-webkit-scrollbar {
      display: none;
      /* WebKit */
    }

    /* Scrollbar elrejtése a news carousel-ben */
    #event-frame {
      scrollbar-width: none;
      /* Firefox */
      -ms-overflow-style: none;
      /* Internet Explorer 10+ */
    }

    #event-frame::-webkit-scrollbar {
      display: none;
      /* WebKit */
    }
  </style>
  
  <!-- Common footer style (copied pattern from index.html) -->
  <style id="footer-common-style">
    /* Common footer style */
    .footer { margin-top: 8px; position: relative; }
    #site-footer .footer-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 14px 18px;
      border-radius: 12px;
      background: #0E1512;
    }
    #site-footer .footer-left img,
    #site-footer .footer-right img {
      height: 28px;
      object-fit: contain;
    }
    #site-footer .footer-center {
      flex: 1 1 auto;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #site-footer .footer-privacy {
      color: #C4C8C3;
      text-decoration: underline;
      cursor: pointer;
      font-size: 14px;
    }
    @media (max-width: 900px) {
      #site-footer .footer-container {
        flex-direction: column;
        gap: 8px;
        padding: 10px 12px;
      }
    }
  </style>
  <script type="importmap">
    {
      "imports": {
        "@material/web/": "https://esm.run/@material/web/"
      }
    }
  </script>
  <script type="text/javascript">
    (function (c, l, a, r, i, t, y) {
      c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) };
      t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i;
      y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y);
    })(window, document, "clarity", "script", "s6n7qpfkv4");
  </script>
  <script type="importmap">
    {
      "imports": {
        "@material/web/": "https://esm.run/@material/web/"
      }
    }
  </script>
  <script type="module">
    import '@material/web/all.js';
    import { styles as typescaleStyles } from '@material/web/typography/md-typescale-styles.js';

    document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
  </script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-analytics.js";
    import { getFirestore, collection, onSnapshot, query, orderBy, limit, startAfter, getDocs } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBRRVx6BtQtCDKjFYA8yh9qYrcUONmkkwI",
      authDomain: "eu2k-hub.firebaseapp.com",
      projectId: "eu2k-hub",
      storageBucket: "eu2k-hub.firebasestorage.app",
      messagingSenderId: "560244867055",
      appId: "1:560244867055:web:3cd51b85baead94989001a",
      measurementId: "G-2JDPR089WD"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getFirestore(app);

    // Make db globally available
    window.db = db;

    /* ---------------------- STUDENTS PAGE ----------------------- */

    // Simple initialization for students page
    window.addEventListener("load", () => {
      console.log('Students page loaded');

      // Add hover effects for buttons
      const controlBtns = document.querySelectorAll('.control-btn');
      const shareBtns = document.querySelectorAll('.share-btn');
      const actionBtns = document.querySelectorAll('.action-btn');

      // Control buttons hover effects - handled by CSS

      // Share buttons hover effects
      shareBtns.forEach(btn => {
        btn.addEventListener('mouseenter', () => {
          btn.style.borderRadius = '160px';
        });
        btn.addEventListener('mouseleave', () => {
          btn.style.borderRadius = '16px';
        });
      });

      // Action buttons hover effects
      actionBtns.forEach(btn => {
        btn.addEventListener('mouseenter', () => {
          btn.style.borderRadius = '160px';
        });
        btn.addEventListener('mouseleave', () => {
          btn.style.borderRadius = '16px';
        });
      });

      // "Tovább" button click handler
      const moreBtn = document.querySelector('.control-btn.more-btn');
      if (moreBtn) {
        moreBtn.addEventListener('click', () => {
          // Scroll to CSE-HO Nap section
          const cseHoSection = document.querySelector('.students-section:nth-child(2)');
          if (cseHoSection) {
            cseHoSection.scrollIntoView({ behavior: 'smooth' });
          }
        });
      }
    });
  </script>
<style id="footer-common-style">
  /* Common footer + minimal main content padding */
  .footer { margin-top: 8px; position: relative; }
  /* Reserve space so footer doesn't overlap content */
  .main-area .main-content { padding-bottom: 84px; }
  #site-footer .footer-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    padding: 14px 18px;
    border-radius: 12px;
    background: #0E1512;
  }
  #site-footer .footer-left img,
  #site-footer .footer-right img {
    height: 28px;
    object-fit: contain;
  }
  #site-footer .footer-center {
    flex: 1 1 auto;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  #site-footer .footer-privacy {
    color: #C4C8C3;
    text-decoration: underline;
    cursor: pointer;
    font-size: 14px;
  }
  @media (max-width: 900px) {
    #site-footer .footer-container {
      flex-direction: column;
      gap: 8px;
      padding: 10px 12px;
    }
  }
</style>
</head>

<body>
  <div class="app-bg">
    <aside class="sidebar">
      <nav class="nav-menu">
        <a class="nav-item" href="control_panel.html">
          <div class="nav-icon-container">
            <img src="/EU2K-Hub/assets/control_panel.svg" class="nav-icon" alt="Vezérlőpult">
          </div>
          <span>Vezérlőpult</span>
        </a>
        <a class="nav-item active" href="students.html">
          <div class="nav-icon-container">
            <img src="/EU2K-Hub/assets/students.svg" class="nav-icon" alt="Diákok">
          </div>
          <span>Diákok</span>
        </a>
        <a class="nav-item" href="calendar.html">
          <div class="nav-icon-container">
            <img src="/EU2K-Hub/assets/calendar.svg" class="nav-icon" alt="Naptár">
          </div>
          <span>Naptár</span>
        </a>
        <a class="nav-item" href="hive.html">
          <div class="nav-icon-container">
            <img src="/EU2K-Hub/assets/hive.svg" class="nav-icon" alt="Hive">
          </div>
          <span>Hive</span>
        </a>
        <div class="sidebar-divider"></div>
        <a class="nav-item" href="index.html">
          <div class="nav-icon-container">
            <img src="/EU2K-Hub/assets/home_icon.svg" class="nav-icon" alt="Otthon">
          </div>
          <span data-translate="navigation.home">Otthon</span>
        </a>
        <a class="nav-item" href="qr-code.html">
          <div class="nav-icon-container">
            <img src="/EU2K-Hub/assets/qr_code_icon.svg" class="nav-icon" alt="QR-Kód">
          </div>
          <span data-translate="navigation.qr" data-translate-fallback="QR-Kód">QR-Kód</span>
        </a>
        <a class="nav-item" href="youhub.html">
          <div class="nav-icon-container">
            <img src="/EU2K-Hub/assets/youhub_icon.svg" class="nav-icon" alt="YouHub">
          </div>
          <span data-translate="navigation.youhub">YouHub</span>
        </a>
        <a class="nav-item" href="event_hub.html">
          <div class="nav-icon-container">
            <img src="/EU2K-Hub/assets/event_hub_icon.svg" class="nav-icon" alt="Event Hub">
          </div>
          <span data-translate="navigation.event_hub">Event Hub</span>
        </a>
      </nav>
    </aside>
    <main class="main-area">
      <div class="main-content">
        <header class="header">
          <div class="welcome-container">
            <img src="/EU2K-Hub/assets/welcome_hand_icon.svg" class="welcome-icon" alt="Welcome">
            <h1 class="welcome-text" data-translate="pages.students.title" data-translate-fallback="Diákok">Diákok</h1>
            <p class="header-subtitle" data-translate="pages.students.groups_by" data-translate-fallback="Csoportok szerint:">Csoportok szerint:</p>
          </div>
          <div class="header-icons">
            <a href="/EU2K-Hub/system/account.html" class="header-icon-link">
              <img src="/EU2K-Hub/assets/account_icon.svg" class="header-icon" alt="Account">
            </a>
            <a href="/EU2K-Hub/settings/settings.html" class="header-icon-link">
              <img src="/EU2K-Hub/assets/settings_icon.svg" class="header-icon" alt="Settings">
            </a>
          </div>
        </header>
        <!-- Első sor: 8.E -->
        <section class="students-section">
          <div class="section-title">
            <span data-translate="pages.students.class_8e" data-translate-fallback="8.E">8.E</span>
            <div class="section-controls">
              <button class="control-btn grid-btn">
                <img src="/EU2K-Hub/teachers/assets/students/grid_view.svg" alt="Grid View">
              </button>
              <button class="control-btn middle-btn">
                <img src="/EU2K-Hub/teachers/assets/students/show_class.svg" alt="Show Class">
                <span data-translate="pages.students.displayed_class_selection" data-translate-fallback="Megjelenített Osztály Kiválasztása">Megjelenített Osztály Kiválasztása</span>
              </button>
              <button class="control-btn select-btn">
                <span data-translate="pages.students.selection" data-translate-fallback="Kiválasztás">Kiválasztás</span>
              </button>
            </div>
          </div>

          <div class="students-row">
            <!-- Első oszlop -->
            <div class="students-column">
              <div class="student-item">
                <div class="student-card">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="student-image" alt="Student">
                </div>
                <div class="student-info">
                  <div class="student-name">Név</div>
                  <div class="student-detail">Azonosító</div>
                  <div class="student-detail">Születési Dátum</div>
                  <div class="student-detail">Email Cím</div>
                </div>
                <button class="share-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/share.svg" alt="Megosztás">
                  <span>Megosztás</span>
                </button>
              </div>

              <div class="student-item">
                <div class="student-card">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="student-image" alt="Student">
                </div>
                <div class="student-info">
                  <div class="student-name">Név</div>
                  <div class="student-detail">Azonosító</div>
                  <div class="student-detail">Születési Dátum</div>
                  <div class="student-detail">Email Cím</div>
                </div>
                <button class="share-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/share.svg" alt="Megosztás">
                  <span>Megosztás</span>
                </button>
              </div>

              <div class="student-item">
                <div class="student-card">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="student-image" alt="Student">
                </div>
                <div class="student-info">
                  <div class="student-name">Név</div>
                  <div class="student-detail">Azonosító</div>
                  <div class="student-detail">Születési Dátum</div>
                  <div class="student-detail">Email Cím</div>
                </div>
                <button class="share-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/share.svg" alt="Megosztás">
                  <span>Megosztás</span>
                </button>
              </div>
            </div>

            <!-- Második oszlop -->
            <div class="students-column">
              <div class="student-item">
                <div class="student-card">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="student-image" alt="Student">
                </div>
                <div class="student-info">
                  <div class="student-name">Név</div>
                  <div class="student-detail">Azonosító</div>
                  <div class="student-detail">Születési Dátum</div>
                  <div class="student-detail">Email Cím</div>
                </div>
                <button class="share-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/share.svg" alt="Megosztás">
                  <span>Megosztás</span>
                </button>
              </div>

              <div class="student-item">
                <div class="student-card">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="student-image" alt="Student">
                </div>
                <div class="student-info">
                  <div class="student-name">Név</div>
                  <div class="student-detail">Azonosító</div>
                  <div class="student-detail">Születési Dátum</div>
                  <div class="student-detail">Email Cím</div>
                </div>
                <button class="share-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/share.svg" alt="Megosztás">
                  <span>Megosztás</span>
                </button>
              </div>

              <div class="student-item">
                <div class="student-card">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="student-image" alt="Student">
                </div>
                <div class="student-info">
                  <div class="student-name">Név</div>
                  <div class="student-detail">Azonosító</div>
                  <div class="student-detail">Születési Dátum</div>
                  <div class="student-detail">Email Cím</div>
                </div>
                <button class="share-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/share.svg" alt="Megosztás">
                  <span>Megosztás</span>
                </button>
              </div>
            </div>

            <!-- Harmadik oszlop (keskenyebb) -->
            <div class="students-column narrow">
              <button class="action-btn primary">
                <span data-translate="pages.students.more" data-translate-fallback="Továbbiak">Továbbiak</span>
                <img src="/EU2K-Hub/teachers/assets/students/forward.svg" alt="Forward">
              </button>
            </div>
          </div>
        </section>

        <!-- CSE-HO Nap oldal -->
        <section class="students-section cse-ho-page">
          <div class="section-title">
            <span data-translate="pages.students.cse_ho_day" data-translate-fallback="CSE-HO Nap:">CSE-HO Nap:</span>
          </div>
          
          <div class="section-subtitle">Rangsor:</div>

          <!-- Rangsor sor -->
          <div class="leaderboard-row">
            <!-- Bal oldali oszlop -->
            <div class="leaderboard-column">
              <div class="leaderboard-image-container">
                <div class="leaderboard-image-box">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="leaderboard-image" alt="Nyertes">
                </div>
                <div class="leaderboard-label">Nyertes</div>
              </div>
            </div>

            <!-- Középső oszlopok -->
            <div class="leaderboard-middle">
              <!-- Toplista oszlop -->
              <div class="leaderboard-column">
                <div class="leaderboard-title">
                  <img src="/EU2K-Hub/teachers/assets/students/trophy_gold.svg" class="trophy-icon" alt="Trophy">
                  <span>Toplista</span>
                </div>
                <div class="leaderboard-item first">
                  <img src="/EU2K-Hub/teachers/assets/students/trophy_gold.svg" class="position-icon" alt="1st">
                  <span class="position-text">Csoport Neve</span>
                  <span class="position-number">1</span>
                </div>
                <div class="leaderboard-item second">
                  <img src="/EU2K-Hub/teachers/assets/students/trophy_silver.svg" class="position-icon" alt="2nd">
                  <span class="position-text">Csoport Neve</span>
                  <span class="position-number">2</span>
                </div>
                <div class="leaderboard-item third">
                  <img src="/EU2K-Hub/teachers/assets/students/trophy_bronze.svg" class="position-icon" alt="3rd">
                  <span class="position-text">Csoport Neve</span>
                  <span class="position-number">3</span>
                </div>
              </div>

              <!-- Divider -->
              <div class="leaderboard-divider"></div>

              <!-- Továbbiak oszlop -->
              <div class="leaderboard-column">
                <div class="leaderboard-title">
                  <img src="/EU2K-Hub/teachers/assets/students/more_leaderboard.svg" class="trophy-icon" alt="More">
                  <span>Továbbiak</span>
                </div>
                <div class="leaderboard-item right first">
                  <img src="/EU2K-Hub/teachers/assets/students/group_name.svg" class="position-icon" alt="Group">
                  <span class="position-text">Csoport Neve</span>
                  <span class="position-number">4</span>
                </div>
                <div class="leaderboard-item right second">
                  <img src="/EU2K-Hub/teachers/assets/students/group_name.svg" class="position-icon" alt="Group">
                  <span class="position-text">Csoport Neve</span>
                  <span class="position-number">5</span>
                </div>
                <div class="leaderboard-item right second">
                  <img src="/EU2K-Hub/teachers/assets/students/group_name.svg" class="position-icon" alt="Group">
                  <span class="position-text">Csoport Neve</span>
                  <span class="position-number">6</span>
                </div>
                <div class="leaderboard-item right second">
                  <img src="/EU2K-Hub/teachers/assets/students/group_name.svg" class="position-icon" alt="Group">
                  <span class="position-text">Csoport Neve</span>
                  <span class="position-number">7</span>
                </div>
                <div class="leaderboard-item right third">
                  <img src="/EU2K-Hub/teachers/assets/students/group_name.svg" class="position-icon" alt="Group">
                  <span class="position-text">Csoport Neve</span>
                  <span class="position-number">8</span>
                </div>
              </div>
            </div>

            <!-- Jobb oldali oszlop -->
            <div class="leaderboard-column">
              <div class="leaderboard-image-container">
                <div class="leaderboard-image-box">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="leaderboard-image" alt="Legutolsó">
                </div>
                <div class="leaderboard-label">Legutolsó</div>
              </div>
            </div>
          </div>

          <!-- Összes Osztály szekció -->
          <div class="section-subtitle">Összes Osztály:</div>
          
          <div class="class-grid">
            <!-- Első sor -->
            <div class="class-row">
              <div class="class-card">
                <div class="class-card-content">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="class-image" alt="Class">
                  <div class="class-info">
                    <div class="class-name">8.E</div>
                    <div class="class-detail">(azonosító)</div>
                    <div class="class-detail">Osztályfőnök neve</div>
                    <div class="class-detail-last">Étel</div>
                  </div>
                </div>
                <button class="class-more-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/forward.svg" alt="More">
                  <span>Tovább</span>
                </button>
              </div>
              
              <div class="class-card">
                <div class="class-card-content">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="class-image" alt="Class">
                  <div class="class-info">
                    <div class="class-name">Osztálynév</div>
                    <div class="class-detail">Azonosító</div>
                    <div class="class-detail">Osztályfőnök neve</div>
                    <div class="class-detail-last">Hiányzás oka</div>
                  </div>
                </div>
                <button class="class-more-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/forward.svg" alt="More">
                  <span>Tovább</span>
                </button>
              </div>
              
              <div class="class-card">
                <div class="class-card-content">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="class-image" alt="Class">
                  <div class="class-info">
                    <div class="class-name">Osztálynév</div>
                    <div class="class-detail">Azonosító</div>
                    <div class="class-detail">Osztályfőnök neve</div>
                    <div class="class-detail-last">Hiányzás oka</div>
                  </div>
                </div>
                <button class="class-more-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/forward.svg" alt="More">
                  <span>Tovább</span>
                </button>
              </div>
            </div>

            <!-- Második sor -->
            <div class="class-row">
              <div class="class-card">
                <div class="class-card-content">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="class-image" alt="Class">
                  <div class="class-info">
                    <div class="class-name">Osztálynév</div>
                    <div class="class-detail">Azonosító</div>
                    <div class="class-detail">Osztályfőnök neve</div>
                    <div class="class-detail-last">Hiányzás oka</div>
                  </div>
                </div>
                <button class="class-more-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/forward.svg" alt="More">
                  <span>Tovább</span>
                </button>
              </div>
              
              <div class="class-card">
                <div class="class-card-content">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="class-image" alt="Class">
                  <div class="class-info">
                    <div class="class-name">Osztálynév</div>
                    <div class="class-detail">Azonosító</div>
                    <div class="class-detail">Osztályfőnök neve</div>
                    <div class="class-detail-last">Hiányzás oka</div>
                  </div>
                </div>
                <button class="class-more-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/forward.svg" alt="More">
                  <span>Tovább</span>
                </button>
              </div>
              
              <div class="class-card">
                <div class="class-card-content">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="class-image" alt="Class">
                  <div class="class-info">
                    <div class="class-name">Osztálynév</div>
                    <div class="class-detail">Azonosító</div>
                    <div class="class-detail">Osztályfőnök neve</div>
                    <div class="class-detail-last">Hiányzás oka</div>
                  </div>
                </div>
                <button class="class-more-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/forward.svg" alt="More">
                  <span>Tovább</span>
                </button>
              </div>
            </div>

            <!-- Hiányzók sor -->
            <div class="section-subtitle small-margin">Hiányzók:</div>
            <div class="class-row">
              <div class="class-card">
                <div class="class-card-content">
                  <img src="/EU2K-Hub/teachers/assets/students/block_icon.svg" class="class-image" alt="Hiányzó">
                  <div class="class-info">
                    <div class="class-name">Osztálynév</div>
                    <div class="class-detail">Azonosító</div>
                    <div class="class-detail">Osztályfőnök neve</div>
                    <div class="class-detail-last">Hiányzás oka</div>
                  </div>
                </div>
                <button class="class-more-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/forward.svg" alt="More">
                  <span>Tovább</span>
                </button>
              </div>
              
              <div class="class-card">
                <div class="class-card-content">
                  <img src="/EU2K-Hub/teachers/assets/students/block_icon.svg" class="class-image" alt="Hiányzó">
                  <div class="class-info">
                    <div class="class-name">Osztálynév</div>
                    <div class="class-detail">Azonosító</div>
                    <div class="class-detail">Osztályfőnök neve</div>
                    <div class="class-detail-last">Hiányzás oka</div>
                  </div>
                </div>
                <button class="class-more-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/forward.svg" alt="More">
                  <span>Tovább</span>
                </button>
              </div>
              
              <div class="class-card">
                <div class="class-card-content">
                  <img src="/EU2K-Hub/teachers/assets/students/block_icon.svg" class="class-image" alt="Hiányzó">
                  <div class="class-info">
                    <div class="class-name">Osztálynév</div>
                    <div class="class-detail">Azonosító</div>
                    <div class="class-detail">Osztályfőnök neve</div>
                    <div class="class-detail-last">Hiányzás oka</div>
                  </div>
                </div>
                <button class="class-more-btn">
                  <img src="/EU2K-Hub/teachers/assets/students/forward.svg" alt="More">
                  <span>Tovább</span>
                </button>
              </div>
            </div>

            <!-- Zsűrik sor -->
            <div class="section-subtitle small-margin">Zsűrik:</div>
            <div class="class-row jury-row">
              <div class="class-card">
                <div class="class-card-content">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="class-image" alt="Class">
                  <div class="class-info">
                    <div class="class-name">Vincze Attila</div>
                    <div class="class-detail">037boo892m19</div>
                  </div>
                </div>
              </div>
              
              <div class="class-card">
                <div class="class-card-content">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="class-image" alt="Class">
                  <div class="class-info">
                    <div class="class-name">Név</div>
                    <div class="class-detail">Azonosító</div>
                  </div>
                </div>
              </div>
              
              <div class="class-card">
                <div class="class-card-content">
                  <img src="/EU2K-Hub/assets/placeholder_img.svg" class="class-image" alt="Class">
                  <div class="class-info">
                    <div class="class-name">Név</div>
                    <div class="class-detail">Azonosító</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

      </div>
      <div style="text-align:center;margin-top:24px;">
        <md-filled-button id="publishBtnNav">Hír / Esemény Publikálása</md-filled-button>
      </div>
      </section>
      <section id="publish-section" style="display:none;"></section>
  </div>
  <div id="site-footer" class="footer" aria-label="Site footer">
    <div class="footer-container">
      <div class="footer-left">
        <img src="../eu2k_hub_logo_hor_dark.png" class="footer-logo-wide" alt="EU2K Hub Logó">
      </div>
      <div class="footer-center">
        <a class="footer-privacy" data-translate="pages.index.privacy_policy" href="/EU2K-Hub/privacy_policy.html">Adatkezelési Tájékoztató</a>
            <a class="footer-privacy" data-translate="pages.index.terms_of_service" href="/EU2K-Hub/terms_of_service.html">Használati Feltételek</a>
      </div>
      <div class="footer-right">
        <img src="../eu2k_devs_logo_hor_dark.png" class="footer-logo-wide" alt="EU2K Devs Logó">
        <img src="../eu2k_dok_logo_hor_dark.png" class="footer-logo-wide" alt="EU2K DÖK Logó">
      </div>
    </div>
  </div>
  </main>
  </div>
  <div id="event-mask"></div>

  <!-- Új dolgok Popup -->
  <div id="newThingsPopup" class="new-things-overlay" style="display: none;">
    <div class="new-things-container">
      <div class="new-things-close-btn" onclick="closeNewThingsPopup()">
        <img src="/EU2K-Hub/assets/close.svg" alt="Bezárás">
      </div>
      <div class="new-things-content">
        <div class="new-things-header">
          <img src="/EU2K-Hub/assets/sparkles.svg" class="new-things-icon-top" alt="Új dolgok">
        </div>
        <h2 class="new-things-title" data-translate="pages.index.new_things_title">New things in the Hub</h2>
        <p class="new-things-subtitle" id="newThingsSubtitle">EU2K Hub 0.2abc - Zárt Béta</p>
        <div class="new-things-image-container">
          <img src="/EU2K-Hub/assets/placeholder_img.svg" class="new-things-image" alt="Új dolgok">
        </div>
        <div class="new-things-list">
          <!-- A lista dinamikusan lesz feltöltve JavaScript által -->
        </div>
        <div class="new-things-footer">
          <a href="https://eu2kdevs.hu" target="_blank" class="new-things-link"
            data-translate="pages.index.more_info_link">
            Továbbiak az <b>eu2kdevs.hu</b> oldalon.
          </a>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Új dolgok popup kezelése
    let newThingsData = null;

    // Popup megnyitása
    function showNewThingsPopup() {
      const popup = document.getElementById('newThingsPopup');
      if (popup) {
        popup.style.display = 'flex';
      }
    }

    // Popup bezárása
    function closeNewThingsPopup() {
      const popup = document.getElementById('newThingsPopup');
      if (popup) {
        popup.style.display = 'none';
      }
    }

    // Popup bezárása overlay-re kattintáskor
    document.addEventListener('DOMContentLoaded', () => {
      const popup = document.getElementById('newThingsPopup');
      if (popup) {
        popup.addEventListener('click', (e) => {
          if (e.target === popup) {
            closeNewThingsPopup();
          }
        });
      }
    });

    // Firebase adatok lekérése és popup megjelenítése
    async function checkAndShowNewThings() {
      try {
        // Firestore v9 függvények importálása
        const { collection, getDocs, query, orderBy, limit } = await import("https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js");

        // Jelenlegi idő lekérése (egyszerűsített verzió)
        const now = new Date();
        const currentTime = now.getTime();

        // Updates kollekció lekérdezése
        const updatesRef = collection(db, 'homePageData', 'new-things', 'updates');
        const q = query(updatesRef, orderBy('publish_date', 'desc'), limit(10));
        const snapshot = await getDocs(q);

        let latestUpdate = null;
        let latestTimestamp = 0;
        let latestUpdateId = null;

        snapshot.forEach(doc => {
          const data = doc.data();
          const publishDate = data.publish_date;

          if (publishDate) {
            const timestamp = publishDate.toDate ? publishDate.toDate().getTime() : publishDate;

            // Ellenőrizzük, hogy a timestamp nem jövőbeli-e (1 óra tolerancia)
            const oneHourInMs = 60 * 60 * 1000;
            if (timestamp <= currentTime + oneHourInMs && timestamp > latestTimestamp) {
              latestTimestamp = timestamp;
              latestUpdate = { ...data, document_id: doc.id }; // Add document ID to data
              latestUpdateId = doc.id;
            }
          }
        });

        if (latestUpdate) {
          const lastShownUpdateId = localStorage.getItem('lastShownNewThingsUpdateId');

          if (lastShownUpdateId !== latestUpdateId) {
            // Pre-translate content
            const translations = {};
            for (const lang of ['en', 'hu']) {
              translations[lang] = {
                state: await translateWithAI(latestUpdate.state, lang),
                new_thing1: await translateWithAI(latestUpdate.new_thing1, lang),
                new_thing2: await translateWithAI(latestUpdate.new_thing2, lang),
              };
            }
            latestUpdate.translations = translations;
            newThingsData = latestUpdate;

            updatePopupContent(newThingsData);
            showNewThingsPopup();

            localStorage.setItem('lastShownNewThingsUpdateId', latestUpdateId);
          }
        }

      } catch (error) {
        console.error('Hiba az új dolgok lekérdezésekor:', error);
      }
    }

    // Popup tartalom frissítése
    function updatePopupContent(data) {
      if (!data) return;
      const targetLanguage = window.translationManager.currentLanguage;
      const translatedData = data.translations[targetLanguage];

      const subtitle = document.getElementById('newThingsSubtitle');
      if (subtitle) {
        const docName = data.document_name || data.document_id || '0.2abc';
        subtitle.textContent = `EU2K Hub ${docName} - ${translatedData.state}`;
      }

      const newThingsList = document.querySelector('.new-things-list');
      if (newThingsList) {
        newThingsList.innerHTML = '';
        const ul = document.createElement('ul');
        ul.style.margin = '0';
        ul.style.paddingLeft = '20px';
        ul.style.listStyleType = 'disc';

        if (translatedData.new_thing1) {
          const li1 = document.createElement('li');
          li1.textContent = translatedData.new_thing1;
          li1.style.color = '#C2C3C2';
          li1.style.marginBottom = '8px';
          li1.style.lineHeight = '1.5';
          ul.appendChild(li1);
        }

        if (translatedData.new_thing2) {
          const li2 = document.createElement('li');
          li2.textContent = translatedData.new_thing2;
          li2.style.color = '#C2C3C2';
          li2.style.marginBottom = '8px';
          li2.style.lineHeight = '1.5';
          ul.appendChild(li2);
        }

        newThingsList.appendChild(ul);
      }

      window.translationManager.applyTranslations();
    }

    // Oldal betöltésekor csekkolás
    window.addEventListener('DOMContentLoaded', () => {
      // Késleltetett csekkolás, hogy a Firebase betöltődjön
      setTimeout(checkAndShowNewThings, 1000);
    });

    // Debug függvény a localStorage reset-hez és popup újra megjelenítéséhez
    // Használat a konzolban: resetNewThingsPopup()
    window.resetNewThingsPopup = function () {
      console.log('🔄 Resetting new things popup tracking...');

      // Töröljük a localStorage-ból az utoljára megjelenített update ID-t
      localStorage.removeItem('lastShownNewThingsUpdateId');
      console.log('✅ Cleared lastShownNewThingsUpdateId from localStorage');

      // Újra futtatjuk a checkAndShowNewThings függvényt
      console.log('🔍 Checking for new updates...');
      checkAndShowNewThings().then(() => {
        console.log('✨ Check complete! If there are updates, the popup should appear.');
      }).catch(error => {
        console.error('❌ Error during check:', error);
      });
    };

    // Debug függvény az összes new things adat törléséhez
    // Használat a konzolban: clearAllNewThingsData()
    window.clearAllNewThingsData = function () {
      console.log('🗑️ Clearing all new things data...');

      // Töröljük az összes kapcsolódó localStorage elemet
      const keysToRemove = ['lastShownNewThingsUpdateId', 'lastNewThingsCheck'];
      keysToRemove.forEach(key => {
        if (localStorage.getItem(key)) {
          localStorage.removeItem(key);
          console.log(`✅ Removed ${key}`);
        }
      });

      console.log('✨ All new things data cleared!');
    };

    // Debug függvény az aktuális állapot megjelenítéséhez
    // Használat a konzolban: showNewThingsStatus()
    window.showNewThingsStatus = function () {
      console.log('📊 Current New Things Status:');
      console.log('Last shown update ID:', localStorage.getItem('lastShownNewThingsUpdateId') || 'None');
      console.log('Last check date:', localStorage.getItem('lastNewThingsCheck') || 'None');
      console.log('Current new things data:', newThingsData || 'No data loaded');
    };
  </script>

  <script src="/EU2K-Hub/assets/js/permissions.js"></script>
  <script src="/EU2K-Hub/assets/js/translations.js"></script>
  <script src="/EU2K-Hub/assets/js/welcome-screen.js"></script>

  <script>
    // Check if user has accepted terms of service
    document.addEventListener('DOMContentLoaded', () => {
      const termsAccepted = localStorage.getItem('termsAccepted');
      if (termsAccepted !== 'true') {
        // Redirect to onboarding if terms not accepted
        window.location.href = '/EU2K-Hub/welcome/onboarding_student.html';
      }
    });
  </script>
  <script>
    // SPA routing és tartalomváltás - Hash alapú navigáció
    const publishSection = document.getElementById('publish-section');
    const publishBtnNav = document.getElementById('publishBtnNav');
    const dashboardSections = Array.from(document.querySelectorAll('.students-section'));

    function showPage(pageId) {
      if (pageId === 'publish') {
        // Diákok szekciók elrejtése
        dashboardSections.forEach(section => section.style.display = 'none');
        publishSection.style.display = '';

        // Template betöltése ha szükséges
        if (!publishSection.innerHTML.trim()) {
          const template = document.getElementById('courses-page');
          if (template) {
            publishSection.appendChild(template.content.cloneNode(true));
            setupCoursesPageLogic();
          }
        }
      } else {
        // Dashboard megjelenítése (alapértelmezett)
        publishSection.style.display = 'none';
        dashboardSections.forEach(section => section.style.display = '');
      }
    }

    function navigate(event, pageId) {
      event.preventDefault();
      location.hash = pageId;
    }

    // Publikálás gomb eseménykezelő
    if (publishBtnNav) {
      publishBtnNav.addEventListener('click', e => {
        navigate(e, 'publish');
      });
    }

    // Hash változás figyelése
    window.addEventListener('hashchange', () => {
      const page = location.hash.substring(1) || 'dashboard';
      showPage(page);
    });

    // Oldal betöltésekor
    window.addEventListener('DOMContentLoaded', () => {
      const initialPage = location.hash.substring(1) || 'dashboard';
      showPage(initialPage);
    });

    // Initial page load (ha már betöltött a DOM)
    if (document.readyState === 'loading') {
      // A DOMContentLoaded esemény fogja kezelni
    } else {
      const initialPage = location.hash.substring(1) || 'dashboard';
      showPage(initialPage);
    }
  </script>
  <script>
    async function setupCoursesPageLogic() {
      if (window.coursesPageLoaded) return;
      window.coursesPageLoaded = true;

      const {
        initializeApp
      } = await import("https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js");
      const {
        getAnalytics
      } = await import("https://www.gstatic.com/firebasejs/11.10.0/firebase-analytics.js");
      const {
        getFirestore,
        collection,
        getDocs,
        setDoc,
        doc,
        Timestamp
      } = await import("https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js");

      const firebaseConfig = {
        apiKey: "AIzaSyBRRVx6BtQtCDKjFYA8yh9qYrcUONmkkwI",
        authDomain: "eu2k-hub.firebaseapp.com",
        projectId: "eu2k-hub",
        storageBucket: "eu2k-hub.firebasestorage.app",
        messagingSenderId: "560244867055",
        appId: "1:560244867055:web:c5bbfe3939fdec9f89001a",
        measurementId: "G-LB2WZ574GJ"
      };

      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
      const db = getFirestore(app);

      // Dátum formázás preview-hoz
      const formatDatePreview = (raw) => {
        if (!raw) return '';
        if (raw.length >= 6) {
          return `${raw.slice(0, 4)}/${raw.slice(4, 6)}/${raw.slice(6)}`;
        } else if (raw.length >= 4) {
          return `${raw.slice(0, 4)}/${raw.slice(4)}`;
        }
        return raw;
      };

      // Dátum input kezelése
      const handleDateInput = (inputEl, previewEl) => {
        inputEl.addEventListener('input', () => {
          let raw = inputEl.value.replace(/\D/g, '').slice(0, 8);
          inputEl.value = raw;
          previewEl.textContent = formatDatePreview(raw);
        });
      };

      handleDateInput(document.getElementById('dateNews'), document.getElementById('datePreviewNews'));
      handleDateInput(document.getElementById('dateEvent'), document.getElementById('datePreviewEvent'));

      // Függvény a mwc textfield-ek törlésére
      const clearMwTextFields = (containerId) => {
        document.querySelectorAll(`#${containerId} md-outlined-text-field`).forEach(el => {
          el.value = '';
        });
      };

      // Hír publikálása
      document.getElementById('publishBtnNews').addEventListener('click', async () => {
        const title = document.getElementById('titleNews').value.trim();
        const hubExclusive = document.getElementById('hubExclusiveNews').checked;
        const author = document.getElementById('authorNews').value.trim();
        const desc = document.getElementById('descNews').value.trim();
        const image = document.getElementById('imageNews').value.trim();
        const link = document.getElementById('linkNews').value.trim();
        const rawDate = document.getElementById('dateNews').value.trim();

        const hibak = [];

        if (!title) hibak.push("Nincs megadva a cím!");
        if (hubExclusive && !author) hibak.push("Hub Exkluzív hírnél kötelező a szerző megadása!");
        if (!desc) hibak.push("Nincs megadva a leírás!");
        if (!image) hibak.push("Nincs megadva a kép URL!");
        if (!link) hibak.push("Nincs megadva a hivatkozás!");
        if (!rawDate) {
          hibak.push("Nincs megadva a dátum!");
        } else if (rawDate.length !== 8) {
          hibak.push("Hibás dátumformátum! Írd be 8 számjeggyel, pl. 20250120.");
        } else {
          const year = rawDate.slice(0, 4);
          const month = rawDate.slice(4, 6);
          const day = rawDate.slice(6, 8);
          const dateObj = new Date(`${year}-${month}-${day}`);
          if (isNaN(dateObj)) {
            hibak.push("Érvénytelen dátum!");
          }
        }

        if (hibak.length > 0) {
          document.getElementById('statusNews').innerHTML = hibak.join("<br>");
          return;
        }

        const year = rawDate.slice(0, 4);
        const month = rawDate.slice(4, 6);
        const day = rawDate.slice(6, 8);
        const dateObj = new Date(`${year}-${month}-${day}`);
        const timestamp = Timestamp.fromDate(dateObj);

        const hirekRef = collection(db, "homePageData", "news", "hirek");
        const snapshot = await getDocs(hirekRef);

        let maxId = 0;
        snapshot.forEach(docSnap => {
          const docId = parseInt(docSnap.id);
          if (!isNaN(docId) && docId > maxId) maxId = docId;
        });

        const newId = (maxId + 1).toString();

        await setDoc(doc(hirekRef, newId), {
          title,
          author: hubExclusive ? author : '',
          desc,
          image,
          link,
          hubExclusive,
          date: timestamp
        });

        document.getElementById('statusNews').textContent = "✅ Hír sikeresen kiadva!";
        clearMwTextFields('newsForm');
        document.getElementById('datePreviewNews').textContent = '';
      });

      // Esemény publikálása
      document.getElementById('publishBtnEvent').addEventListener('click', async () => {
        const title = document.getElementById('titleEvent').value.trim();
        const place = document.getElementById('placeEvent').value.trim();
        const description = document.getElementById('descriptionEvent').value.trim();
        const image = document.getElementById('imageEvent').value.trim();
        const link = document.getElementById('linkEvent').value.trim();
        const rawDate = document.getElementById('dateEvent').value.trim();

        const hibak = [];

        if (!title) hibak.push("Nincs megadva a cím!");
        if (!place) hibak.push("Nincs megadva a helyszín!");
        if (!description) hibak.push("Nincs megadva a leírás!");
        if (!image) hibak.push("Nincs megadva a kép URL!");
        if (!rawDate) {
          hibak.push("Nincs megadva a dátum!");
        } else if (rawDate.length !== 8) {
          hibak.push("Hibás dátumformátum! Írd be 8 számjeggyel, pl. 20250120.");
        } else {
          const year = rawDate.slice(0, 4);
          const month = rawDate.slice(4, 6);
          const day = rawDate.slice(6, 8);
          const dateObj = new Date(`${year}-${month}-${day}`);
          if (isNaN(dateObj)) {
            hibak.push("Érvénytelen dátum!");
          }
        }

        if (hibak.length > 0) {
          document.getElementById('statusEvent').innerHTML = hibak.join("<br>");
          return;
        }

        const year = rawDate.slice(0, 4);
        const month = rawDate.slice(4, 6);
        const day = rawDate.slice(6, 8);
        const dateObj = new Date(`${year}-${month}-${day}`);
        const timestamp = Timestamp.fromDate(dateObj);

        const esemenyekRef = collection(db, "homePageData", "events", "esemenyek");
        const snapshot = await getDocs(esemenyekRef);

        let maxId = 0;
        snapshot.forEach(docSnap => {
          const docId = parseInt(docSnap.id);
          if (!isNaN(docId) && docId > maxId) maxId = docId;
        });

        const newId = (maxId + 1).toString();

        await setDoc(doc(esemenyekRef, newId), {
          title,
          description,
          place,
          image,
          link,
          date: timestamp
        });

        document.getElementById('statusEvent').textContent = "Esemény sikeresen publikálva!";
        clearMwTextFields('eventForm');
        document.getElementById('datePreviewEvent').textContent = '';
      });

      // Hub Exkluzív checkbox logika
      document.getElementById('hubExclusiveNews').addEventListener('change', function () {
        const authorField = document.getElementById('authorNews');
        if (this.checked) {
          authorField.removeAttribute('disabled');
        } else {
          authorField.setAttribute('disabled', '');
          authorField.value = '';
        }
      });

      // Vissza gomb funkció
      document.getElementById('backToHome').addEventListener('click', function (e) {
        e.preventDefault();
        location.hash = 'dashboard';
      });
    }
  </script>
</body>
<template id="courses-page">
  <div class="publish-layout">
    <div class="back-arrow-column">
      <md-filled-button id="backToHome" class="back-arrow-btn">
        <img src="/EU2K-Hub/assets/arrowback.svg" alt="Vissza" class="arrow-img">
      </md-filled-button>
    </div>
    <div class="publish-content">
      <header class="header">
        <div class="welcome-container">
          <img src="/EU2K-Hub/assets/add_news.svg" class="welcome-icon" alt="Új Hír">
          <h1 class="welcome-text">Új hír publikálása</h1>
        </div>
        <div class="header-icons">
          <a href="/EU2K-Hub/system/account.html" class="header-icon-link">
            <img src="/EU2K-Hub/assets/account_icon.svg" class="header-icon" alt="Account">
          </a>
          <a href="/EU2K-Hub/settings/settings.html" class="header-icon-link">
            <img src="/EU2K-Hub/assets/settings_icon.svg" class="header-icon" alt="Settings">
          </a>
        </div>
      </header>
      <section class="form-card">
        <div class="form" id="newsForm">
          <md-outlined-text-field label="Cím" id="titleNews"></md-outlined-text-field>
          <md-outlined-text-field label="Szerző" id="authorNews" disabled></md-outlined-text-field>
          <md-outlined-text-field label="Leírás" id="descNews"></md-outlined-text-field>
          <md-outlined-text-field label="Kép URL" id="imageNews"></md-outlined-text-field>
          <md-outlined-text-field label="Link" id="linkNews"></md-outlined-text-field>
          <md-outlined-text-field label="Dátum (pl. 20250120)" id="dateNews" maxlength="8" type="text"
            autocomplete="off">
          </md-outlined-text-field>
          <div id="datePreviewNews" class="date-preview"></div>
          <div style="margin-bottom: 16px;">
            <md-checkbox id="hubExclusiveNews"></md-checkbox>
            <label for="hubExclusiveNews">Hub Exkluzív</label>
          </div>
          <md-filled-button id="publishBtnNews">Publikálás</md-filled-button>
        </div>
        <p id="statusNews" class="status-text"></p>
      </section>

      <section class="form-card">
        <div class="welcome-container">
          <img src="/EU2K-Hub/assets/add_event.svg" class="welcome-icon" alt="Új esemény">
          <h1 class="welcome-text">Új esemény publikálása</h1>
        </div>
        <div class="form" id="eventForm">
          <md-outlined-text-field label="Cím" id="titleEvent"></md-outlined-text-field>
          <md-outlined-text-field label="Helyszín" id="placeEvent"></md-outlined-text-field>
          <md-outlined-text-field label="Leírás" id="descriptionEvent"></md-outlined-text-field>
          <md-outlined-text-field label="Kép URL" id="imageEvent"></md-outlined-text-field>
          <md-outlined-text-field label="Link" id="linkEvent"></md-outlined-text-field>
          <md-outlined-text-field label="Dátum (pl. 20250120)" id="dateEvent" maxlength="8" type="text"
            autocomplete="off">
          </md-outlined-text-field>
          <div id="datePreviewEvent" class="date-preview"></div>
          <md-filled-button id="publishBtnEvent">Publikálás</md-filled-button>
        </div>
        <p id="statusEvent" class="status-text"></p>
      </section>
    </div>
  </div>
</template>

</html>
</div>
</main>
</div>

<div id="site-footer" class="footer" aria-label="Site footer">
  <div class="footer-container">
    <div class="footer-left">
      <img src="../eu2k_hub_logo_hor_dark.png" class="footer-logo-wide" alt="EU2K Hub Logó">
    </div>
    <div class="footer-center">
      <a class="footer-privacy" data-translate="pages.index.privacy_policy" href="/EU2K-Hub/privacy_policy.html">Adatkezelési Tájékoztató</a>
            <a class="footer-privacy" data-translate="pages.index.terms_of_service" href="/EU2K-Hub/terms_of_service.html">Használati Feltételek</a>
    </div>
    <div class="footer-right">
      <img src="../eu2k_devs_logo_hor_dark.png" class="footer-logo-wide" alt="EU2K Devs Logó">
      <img src="../eu2k_dok_logo_hor_dark.png" class="footer-logo-wide" alt="EU2K DÖK Logó">
    </div>
  </div>
</div>

</body>

</html>
